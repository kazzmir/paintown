#!/bin/bash -e

docker build -t paintown-ps3-build -f docker/Dockerfile.ps3 .
docker run --rm -iv${PWD}:/paintown-bin -w /paintown-bin paintown-ps3-build sh -s <<EOF

# FIXME - Replace it for meson build
ppu-g++ -Wall -O2 -mcpu=cell -o paintown.ps3 /paintown-bin/misc/ps3/sdl2-example.cpp -mhard-float -fmodulo-sched -ffunction-sections -fdata-sections -maltivec -mminimal-toc \
-I/usr/local/include \
-L/usr/local/lib -lSDL2 -lm -lgcm_sys -lrsx -lsysutil -lio -laudio -lrt -llv2 -lio -laudio

EOF
echo "
To run you will need a CFW [custom firmware] or system that can boot unsigned applications
"

ls -l paintown.ps3
file paintown.ps3
echo "Here is the executable. To run you need to package as a pkg file"
